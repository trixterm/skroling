.stage {
  position: relative;
  border-radius: 14px;
  overflow: hidden;

  /* pilkas fonas su gardele (kaip video) */
  background:
    linear-gradient(to right, rgba(255,255,255,0.10) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255,255,255,0.10) 1px, transparent 1px),
    linear-gradient(#8f9094, #7f8084);
  background-size: var(--cell) var(--cell), var(--cell) var(--cell), auto;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
}

.blocks {
  position: absolute;
  inset: 0;
}

.block {
  position: absolute;
  width: calc(var(--cell) - 3px);
  height: calc(var(--cell) - 3px);
  border-radius: 4px;
  background: #111;
  transform: translate(var(--fromX), var(--fromY)) scale(var(--fromS));
  opacity: var(--fromO);

  /* “išsiardymas → susidėjimas” */
  animation: morph var(--dur) cubic-bezier(0.2, 0.8, 0.2, 1) both;
  will-change: transform, opacity;
}

@keyframes morph {
  0% {
    transform: translate(var(--fromX), var(--fromY)) scale(var(--fromS));
    opacity: var(--fromO);
  }

  /* išsiardymo fazė */
  48% {
    transform:
      translate(calc(var(--fromX) + var(--sx)), calc(var(--fromY) + var(--sy)))
      scale(1);
    opacity: 1;
  }

  /* susidėjimo fazė */
  100% {
    transform: translate(var(--toX), var(--toY)) scale(var(--toS));
    opacity: var(--toO);
  }
}

.caption {
  position: absolute;
  right: 10px;
  bottom: 8px;
  font: 600 12px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: rgba(0,0,0,0.55);
  user-select: none;
}
